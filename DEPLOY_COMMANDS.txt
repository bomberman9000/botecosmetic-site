# Команды для выполнения на сервере (копируйте и выполняйте по порядку)

# 1. Создаём директорию и переходим в неё
mkdir -p /var/www/bote-site
cd /var/www/bote-site

# 2. Распаковываем архив
tar -xzf /tmp/deploy.tar.gz
rm /tmp/deploy.tar.gz

# 3. Устанавливаем Node.js (если не установлен)
if ! command -v node &> /dev/null; then
    curl -fsSL https://deb.nodesource.com/setup_18.x | bash -
    apt-get install -y nodejs
fi

# 4. Устанавливаем PM2 (если не установлен)
if ! command -v pm2 &> /dev/null; then
    npm install -g pm2
fi

# 5. Устанавливаем зависимости
npm install --production

# 6. Собираем проект
npm run build

# 7. Останавливаем старое приложение (если есть)
pm2 delete bote-site 2>/dev/null || true

# 8. Запускаем приложение
pm2 start npm --name "bote-site" -- start
pm2 save

# 9. Проверяем статус
pm2 list

# 10. Проверяем логи
pm2 logs bote-site --lines 30



